<!DOCTYPE html>
 
<html>
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Трейдинговые системы для чайников</title>
   <link href="/favicon.png" rel="icon" />
   <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-3017739-19']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" type="text/css" href="/css/highlight.css" />
   <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" />
   <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" /> 
   <link rel="alternate" title="Программирование - это просто!" href="/atom.xml" type="application/atom+xml">
</head>
<body>

<div class="site">

  <div class="menu">
    <a class="extra" href="/english">&laquo; english &raquo;</a>  
    <a href="/">блог</a> |
    <a href="/projects/">проекты</a> |
    <a href="/interview/">интервью</a> |
    <a href="/articles/">статьи</a> |
    <a href="/about/">автор</a>
  </div>

  <div id="home">
    <h1>Трейдинговые системы для чайников</h1>
<div id="post">
  <p>В данной статье я попытаюсь рассказать некоторых идеях, лежащих в основе трейдинговых систем. Изложение будет максимально простым, по возможности без технических и экономических заумностей.</p>

<p>Так как данная сфера деятельности активно развивается в англоязычном мире, то многие термины проще использовать без перевода, чтобы не потерять по дороге смысл.</p>

<p>Рассмотрение будет сфокусировано на техническую сторону вопроса с точки зрения компьютерной автоматизации процесса электронной торговли ценными бумагами. Для прояснения сопутствующих вопросов (в основном из общей экономической теории ценных бумаг) следует обраться к другим источниками.</p>

<p>Итак, для начала несколько простых определений.</p>

<p>Трейдинг - это торговля ценными бумагами. Соответственно, трейдинговая система (платформа) предоставляет автоматизацию этого процесса для различных участников торгов: для тех, кто продает и покупает, и для третьих лиц, предоставляющих различные сервисы и живущие на комиссию.</p>

<p>Надо отметить, что многие принципы электронной торговли повторяют то, как это происходило раньше, когда не было компьютеров. Но даже сейчас, в эру тотальной компьютеризации, в трейдинге весьма много ручной работы, причем несвязанной напрямую с принятием решения о покупке или продаже.</p>

<p>Ценная бумага - это объект торговли (в английском языке это называется &ldquo;security&rdquo;). Типов ценных бумаг очень много (акции, облигации, валюта и т.д.). Я не буду вдаваться в объяснение их сути (для этого следует обраться к литературе по экономике), так как с точки зрения компьютерной системы каждая ценная бумага - это всего лишь идентификатор. Например, &ldquo;GOOG US Equity&rdquo; - это акции Гугла на Нью-Йоркской фондовой бирже, &ldquo;VOD LN Equity&rdquo; - это акции Vodafone на Лондонской бирже, &ldquo;CT2 Govt&rdquo; - это двухлетние государственные облигации правительства США и т.д. Таких идентификаторов тысячи, и в целом большинство электронных систем торговли стараются соблюдать уникальность данных идентификаторов во избежание путаницы при операции между различными платформами.</p>

<p>Каждая система может иметь (и обычно имеет) внутреннюю систему идентификации ценных бумаг для удобства их учета.</p>

<p>Сделка (или trade) - это факт покупки/продажи ценных бумаг. Сделка обычно имеет несколько базовых характеристик: дата/время, идентификатор ценной бумаги, сумма за единицу и количество купленных/проданных единиц ценной бумаги. Данный квант информации обычно называется tick (или feed). Именно поток таких тиков, получаемых в режиме реального времени с различных торговых платформ, и является основным источником различных сводок, диаграмм, графиков, бегущих строк и т.д., описывающих &ldquo;состояние фондового рынка&rdquo;, по которым трейдеры принимают решение о том, что покупать или продавать, когда и почем.</p>

<p>Скорость поступления тиков может быть весьма высока (сотни или даже тысячи в секунду). Это объясняет, почему одним из важнейших показателей для трейдинговой системы является быстродействие. Чем быстрее обрабатываются входные данные, тем быстрее трейдер узнает об изменениях на рынке, и тем быстрее может принять решение. А для алгоритмического трейдинга (мы поговорим об это чуть ниже) - это вообще один из основных показателей. Это быстродействие может складывается из многих факторов: быстрота программного обеспечения, скорость информационных каналов (часто используются выделенные линии, а не публичные сети типа интернета), производительность аппаратного обеспечения и т.д.</p>

<p>Может так случиться, что из-за каких-то проблем в системе, из-за которой она работает очень медленно, может начаться попуск тиков (система не успевает их обрабатывать). В этом случаем требуется периодическая сверка обобщенных показателей, чтобы не отображать неверные данные.</p>

<p><strong>Основные участники рынка ценных бумаг</strong></p>

<p>Sell side (я оставлю этот термин без перевода) - это те, что ориентирован на перепродажу. Трейдеры - это типичные представители sell side. Обычно они не имеют своих активов. У них просто есть немного денег. В начале торгового дня они покупают что-то, а потом в течение дня могут перепродавать, покупать другое и т.д. В конце дня они обычно все стремятся распродать, даже если придется продать в убыток. Sell side обычно зарабатывает на быстрых дневных изменениях курсов, вызванных, например, неожиданными новостями.</p>

<p>Экономическая причина существования sell side - это, как в случае <a href="/blog/russian/2010/01/26/common-misconceptions-about-bank-cards/">процессинговых систем</a>, вопрос объема. То есть, нельзя просто так взять, и кому угодно подключиться к фондовой бирже, так как это стоит денег (депозиты, оборудование, сертификация, если потребуется и т.д.). Высокий ценовой ценз сделан для отсечения мелких клиентов (бирже не интересно возиться с клиентами, покупающими одну акцию в год). Последние должны будут пользоваться услугами более крупных трейдинговых фирм, и им уже придется платить комиссию.</p>

<p>Buy side - это &ldquo;богатые&rdquo; участники. Обычно это фонды, банки, страховые компании и т.д. По большому счету - это настоящие держатели ценных бумаг. Они их покупают помногу, с долгой перспективой, и обычно зарабатывают при росте цен (или теряют при их падении, такое тоже бывает) на длительном (несколько лет, например) интервале времени.</p>

<p>То есть в течение торгового дня sell side перепродает туда-сюда ценные бумаги от buy side, а к концу дня все снова фактически возвращается к buy side, и sell side имеет свою дневную разницу.</p>

<p>Конечно, такое разделение может быть весьма условным, и многие финансовые институты являются одновременно sell side и buy side. Но понимание этого различия весьма важно.</p>

<p>Рассмотрим некоторые важные части трейдинговой системы.</p>

<p><strong>Мониторинг</strong></p>

<p>Данная подсистема занимается получением различных входных данных о сделках (собственных и от других систем, новостей и т.д.) и предоставлением всего этого вала информации в удобном для анализа виде (таблицы, графики, статистика). Надо сказать, что новости являются очень важной частью, так как рынок, особенно такой подвижный, как фондовый, а особенно такой подвижный из-за его тотальной компьютеризации, реагирует мгновенно. С момента, как на сайте какой-то компании появился пресс релиз, например, о смене руководства, до начала активного движения цен ценных бумаг данной компании на рынке из-за этого пресс релиза проходят секунды. И тот, кто получил новость быстрее, тот и сумел среагировать и как результат - заработать.</p>

<p>Про новостные системы стоит сказать особо. Они состоят из нескольких уровней. После получения того или иного факта, на первом уровне новость ужимается в одно предложение из нескольких слов и тут же публикуется. Это позволяет для новостного провайдера выпустить новость очень быстро (буквально несколько минут), а для потребителя новости (например, трейдера), увидев новую строчку в новостной ленте (а не читать целый абзац) уловить суть и, если надо, начать действовать. Например, &ldquo;ГАЗПРОМ снял генерального директора&rdquo; или &ldquo;Сбербанк объявил о банкротстве&rdquo;. Далее новость передается на следующий уровень, где пишется уже абзац или два с более детальным описанием. Тут уже может пройти час или два. Если изначальная новость была бомбой, то многие будут ждать этого описания, а если нет, то возможно никто ее и не станет читать. Ну а затем уже на третьем уровне много позже могут написать детальную аналитику, и, например, включить мнения экспертов на влияние новости на те или иные рынки, ценные бумаги и т.д.</p>

<p><strong>Системы учета позиций и истории сделок</strong></p>

<p>Этот механизм позволяет трейдеру вести учет своей дневной деятельности. Фактически, это журнал его действий: купил это за столько, продал это тому-то. Кажущаяся на первый взгляд утилитарность и простота данной системы на самом деле ошибочна. Система учета позиций и истории сделок позволяет трейдеру моментально видеть, сколько и на сколько он продал и купил, и каковы его цены по сравнению с другими участниками рынка. Кстати, множество сделок до сих пор совершаются просто по телефону, и такие сделки надо где-то фиксировать. И немаловажно, на этом уровне происходит контроль ограничений самого трейдера. Например, данный трейдер не может торговать в день не более такой-то суммы, или что нельзя уходить в долг на такой-то ценной бумаге более чем на столько, или если трейдер вводит сделку более такой-то суммы, то запрашивается разрешения его начальника и т.д. Система контроля может быть очень и очень изощренной.</p>

<p>Алгоритмический трейдинг может также работать на этом уровне. Специальная программа, а не человек (или может человек, но который не управляет каждой отдельной сделкой, а запускает специальные скрипты, делающие за него эту работу), на основе информации с рынка принимает решения покупать или продавать. Программа может делать это очень быстро, гораздо быстрее человека, и, пользуясь очевидной логикой, когда что-то продают, то оно тут же дешевеет, а когда покупают - тут же дорожает, можно управляемо двигать цены на рынке, и тем самым иметь высоковероятностные предсказания о движении цены, и, как результат, вовремя (= выгодно) продать или купить.</p>

<p><strong>Системы проведения сделок</strong></p>

<p>Обычно, работа трейдера - это договориться о сделке. Электронно или по телефону - неважно. Проведение сделки обычно происходит после закрытия рынков. И этим занимается middle office. На данном этапе могут также проводиться дополнительные проверки активности трейдера.</p>

<p>Различные истории о трейдерах, нелегально что-то там наторговавших, обычно связаны именно с тем, что трейдер смог провести сделку без каких-то проверок, или нашел способ эти проверки обойти.</p>

<p>Автоматизация процесса тут обычно заключается в том, чтобы электронным образом разослать контрагентам информацию о проведенных сделках, получить ответы от них и подготовить данные для финансового отдела, который будет физически проводить расчеты с контрагентами.</p>

<p><strong>Анонимная торговля</strong></p>

<p>Первым способом торговли может быть, когда трейдер напрямую покупает (или продает) у конкретного контрагента (например, у своего постоянного партнера).</p>

<p>Альтернативным способом сведения покупателя и продавца может быть анонимная торговля. В этом случае покупателю (или продавцу) без разницы, кто его контрагент, так как его интересует только цена. Для автоматизации такой анонимной торговли есть специальные механизмы.</p>

<p><em>Устройство электронного рынка для анонимной торговли</em></p>

<p>Электронный рынок обычно устроен по следующей схеме. Есть такое понятие, как &ldquo;Market depth&rdquo;. Мне не очень нравится перевод &ldquo;глубина рынка&rdquo;, поэтому я оставлю термин без перевода. &ldquo;Market depth&rdquo; - это таблица лучшего спроса и предложения на рынке для выбранной ценной бумаги. Выглядит она примерно так:</p>

<pre><code>   Bid       Offer
---------+----------
Ц1 х К1  | Ц5 х К5
---------+----------
Ц2 х К2  | Ц6 х К6
---------+----------
Ц3 х К3  | Ц7 х К7
---------+----------
        ...
---------+----------
Ц4 х К4  | Ц8 х К8
---------+----------
</code></pre>

<p>Колонка Bid - это цены и объемы того, что люди хотят купить (список текущего спроса). Эта колонка отсортирована по убыванию цены:</p>

<pre><code>Ц1 &gt; Ц2 &gt; Ц3 &gt; ... &gt; Ц4
</code></pre>

<p>То есть физический смысл этой колонки - это показать лучшие (= наибольшие) с точки зрения потенциального продавца цены (и возможные объемы) по данной ценной бумаге.</p>

<p>Допустим, ячейки &ldquo;Ц1 х К1&rdquo; пока нет, а на вершине колонки Bid находится &ldquo;Ц2 х К2&rdquo;. Я, как участник рынка, говорю «я хочу купить ценную бумагу N по цене &ldquo;Ц1&rdquo; в количестве &ldquo;К1&rdquo;». Так как моя цена больше цены &ldquo;Ц2&rdquo;, то моя заявка становится на вершину колонки.</p>

<p>Колонка &ldquo;Offer&rdquo; (или иногда ее называют &ldquo;Ask&rdquo;) - это цены и объем того, что люди хотят купить (список текущих предложений). Эта колонка отсортирована по возрастанию цены:</p>

<pre><code>Ц5 &lt; Ц6 &lt; Ц7 &lt; ... &lt; Ц8
</code></pre>

<p>Физический смысл этой колонки - это показать лучшие (= наименьшие) с точки зрения потенциального покупатели цены (и объемы) по данной ценной бумаге.</p>

<p>Далее начинается самое интересное. Как известно, спрос удовлетворяет предложение и наоборот. Так вот данная таблица и является механизмом сопоставления спроса и предложения.</p>

<p>Если я прихожу на рынок и говорю «я хочу купить ценную бумагу N по цене &ldquo;Ц1&rdquo; и количестве &ldquo;К1&rdquo;», система берет таблицу &ldquo;Market depth&rdquo; для ценной бумаги N и просматривает колонку &ldquo;Offer&rdquo;.</p>

<p>Если какая-то цена совпадает с моей (например, &ldquo;Ц6&rdquo;), то система автоматически удовлетворяет мою заявку и продает мне нужное количество ценных бумаг N по цене &ldquo;Ц1&rdquo; (= &ldquo;Ц6&rdquo;) и в количестве &ldquo;К1&rdquo;. И ячейка &ldquo;Ц1 х К1&rdquo; не появляется в колонке спроса &ldquo;Bid&rdquo;, так как мой спрос удовлетворен. Если мое запрошенное количество &ldquo;К1&rdquo; равно &ldquo;К6&rdquo;, то строка &ldquo;Ц6 х К6&rdquo; удаляется из колонки предложений &ldquo;Offer&rdquo;. Если мое количество &ldquo;К1&rdquo; меньше &ldquo;К6&rdquo;, то строка &ldquo;Ц6 х К6&rdquo; остается в колонке, но из &ldquo;К6&rdquo; просто вычитается &ldquo;К1&rdquo;. Ну а если же мое количество &ldquo;К1&rdquo; больше &ldquo;К6&rdquo;, то строка &ldquo;Ц6 х К6&rdquo; удаляется из колонки &ldquo;Offer&rdquo; (это предложение полностью удовлетворено), а в колонке &ldquo;Bid&rdquo; появляется моя строка &ldquo;Ц1 х К1&rdquo;, где &ldquo;K1&rdquo; отображается за вычетом &ldquo;K6&rdquo;, то есть &ldquo;Ц1 х K1-K6&rdquo;.</p>

<p>Аналогично, для продажи. Если я прихожу на рынок и говорю «я хочу продать ценную бумагу N по цене &ldquo;Ц6&rdquo; и количестве &ldquo;К6&rdquo;», система берет таблицу &ldquo;Market depth&rdquo; для ценной бумаги N и просматривает колонку &ldquo;Bid&rdquo;.</p>

<p>Если какая-то цена совпадает с моей (например, &ldquo;Ц2&rdquo;), то система автоматически удовлетворяет мою заявку и покупает у меня нужное количество ценных бумаг N по цене &ldquo;Ц6&rdquo; (= &ldquo;Ц2&rdquo;) и в количестве &ldquo;К6&rdquo;. И ячейка &ldquo;Ц6 х К6&rdquo; не появляется в колонке спроса &ldquo;Offer&rdquo;, так как моё предложение удовлетворено. Если мое запрошенное количество &ldquo;К6&rdquo; равно &ldquo;К2&rdquo;, то строка &ldquo;Ц2 х К2&rdquo; удаляется из колонки предложений &ldquo;Bid&rdquo;. Если мое количество &ldquo;К6&rdquo; меньше &ldquo;К2&rdquo;, то строка &ldquo;Ц2 х К2&rdquo; остается в колонке, но из &ldquo;К2&rdquo; просто вычитается &ldquo;К6&rdquo;. Ну а если же мое количество &ldquo;К6&rdquo; больше &ldquo;К2&rdquo;, то строка &ldquo;Ц2 х К2&rdquo; удаляется из колонки &ldquo;Bid&rdquo; (этот спрос полностью удовлетворен), а в колонке &ldquo;Offer&rdquo; появляется строка &ldquo;Ц6 х К6&rdquo;, где &ldquo;K6&rdquo; отображается за вычетом &ldquo;K2&rdquo;, то есть &ldquo;Ц6 х K6-K2&rdquo;.</p>

<p>По сути, таблица &ldquo;Market Depth&rdquo; отображает список пока еще неудовлетворенных спросов и предложений. Как только находится для спроса парное предложение или наоборот - между ними производится сделка (trade), и эта пара удаляется из таблицы (одна из сторон может после сделки таки остаться в таблице &ldquo;Market Depth&rdquo;, если, как описано выше, не было полного совпадения по количеству).</p>

<p>Обычно &ldquo;Market depth&rdquo; отображает в среднем от 10 до 100 уровней цен по спросу и предложению. Больше нет особого смысла нет.</p>

<p>Кроме того, каждая ячейка данной таблицы может раскрываться списком заявок по цене. Что это значит? Например, ячейка &ldquo;Ц1 х K2&rdquo; может быть агрегированным по цене показателем, то есть количество &ldquo;К1&rdquo; является предложением не единственного покупателя, а многих (несколько покупателей могут хотеть купить по цене &ldquo;Ц1&rdquo;), но так как для продавца неважно, кому именно продавать (цена то все равно одна и та же, и система в целом анонимна), по умолчанию эта детализация может не отображаться.</p>

<p>Механизм сопоставления спроса и предложения по таблице &ldquo;Market Depth&rdquo; лежит в основе анонимного трейдинга, и так называемый алгоритмический трейдинг может быть построен на программировании логики автоматизированной торговли, основанной на анализе данных таблицы &ldquo;Market Depth&rdquo;.</p>

<p>Для алгоритмического трейдинга система предоставляет программный интерфейс (API), который может быть, как вариант, скриптовым языком, например, Lua, с набором функций для просмотра таблиц &ldquo;Market Depth&rdquo; и для помещения в систему заявок на покупку или продажу. Логика же программируется автором скрипта.</p>

<p>Интересно, что порой трейдеры хранят свои скрипты в большой тайне, и даже в случае технических неполадок (например, скрипт работает не как ему положено), отказываются их показать техслубже, хотя решить техническую проблему при этом требуют.</p>

<p>Мы рассмотрели некоторые из основных понятий, терминов и механизмов трейдинговых систем на начальном уровне. Многие из описанных механизмов в реальности сложнее и гибче, но основные принципы от этого не меняются.</p>

<p>Посты по теме:</p>

<ul>
<li><a href="/blog/russian/2010/01/26/common-misconceptions-about-bank-cards/">Распространенные заблуждения про банковские карточки</a></li>
<li><a href="/blog/russian/2010/02/12/thirty-seconds-format/">Формат 32nd (thirty seconds)</a></li>
</ul>

</div>

<hr />


  <a href="http://easy-coding.blogspot.com/2010/03/blog-post.html"><small>Оригинальный пост</small></a> |


<a href="/about/"><small>Disclaimer</small></a>

<h1>Комментарии</h1>

<div id="disqus_thread"></div>

<script type="text/javascript">
  var disqus_shortname = 'easy-coding';
  var disqus_developer = 0;
  var disqus_identifier = 'http://easy-coding.blogspot.com/2010/03/blog-post.html';
  var disqus_url = 'http://easy-coding.blogspot.com/2010/03/blog-post.html';
  var disqus_script = 'embed.js';
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>


  </div>

  <div class="footer">
    <div class="contact">
      &copy; 2009-2013
      <a href="mailto:alexander@demin.ws">Александр Дëмин</a> |
      <a href="/atom.xml" rel="subscribe-rss" title="Подписаться через RSS">RSS</a>
    </div>
  </div>

</div>

</body>
</html>
